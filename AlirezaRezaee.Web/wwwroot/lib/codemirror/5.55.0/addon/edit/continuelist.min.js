!function(e){"object"==typeof exports&&"object"==typeof module?e(require("../../lib/codemirror")):"function"==typeof define&&define.amd?define(["../../lib/codemirror"],e):e(CodeMirror)}(function(v){"use strict";var I=/^(\s*)(>[> ]*|[*+-] \[[x ]\]\s|[*+-]\s|(\d+)([.)]))(\s*)/,w=/^(\s*)(>[> ]*|[*+-] \[[x ]\]|[*+-]|(\d+)[.)])(\s*)$/,b=/[*+-]\s/;function y(e,n){var t=n.line,i=0,r=0,o=I.exec(e.getLine(t)),l=o[1];do{var s=t+(i+=1),a=e.getLine(s),c=I.exec(a);if(c){var d=c[1],f=parseInt(o[3],10)+i-r,u=parseInt(c[3],10),p=u;if(l!==d||isNaN(u)){if(l.length>d.length)return;if(l.length<d.length&&1===i)return;r+=1}else f===u&&(p=u+1),u<f&&(p=1+f),e.replaceRange(a.replace(I,d+p+c[4]+c[5]),{line:s,ch:0},{line:s,ch:a.length})}}while(c)}v.commands.newlineAndIndentContinueMarkdownList=function(e){if(e.getOption("disableInput"))return v.Pass;for(var n=e.listSelections(),t=[],i=0;i<n.length;i++){var r=n[i].head,o=e.getStateAfter(r.line),l=v.innerMode(e.getMode(),o);if("markdown"!==l.mode.name)return void e.execCommand("newlineAndIndent");var s,a,c,d,f,u,p=!1!==(o=l.state).list,g=0!==o.quote,h=e.getLine(r.line),m=I.exec(h),x=/^\s*$/.test(h.slice(0,r.ch));if(!n[i].empty()||!p&&!g||!m||x)return void e.execCommand("newlineAndIndent");w.test(h)?(s=g&&/>\s*$/.test(h),a=!/>\s*$/.test(h),(s||a)&&e.replaceRange("",{line:r.line,ch:0},{line:r.line,ch:r.ch+1}),t[i]="\n"):(c=m[1],d=m[5],u=(f=!(b.test(m[2])||0<=m[2].indexOf(">")))?parseInt(m[3],10)+1+m[4]:m[2].replace("x"," "),t[i]="\n"+c+u+d,f&&y(e,r))}e.replaceSelections(t)}});